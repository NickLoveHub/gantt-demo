<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="../lib/dhtmlxgantt_nio.js"></script>
    <link href="../lib/dhtmlxgantt_nio.css" rel="stylesheet">
    <style>
    .nioBlue{
        color: #ffffff !important;
        background-color: #00BEBE;
        border: 1px solid #00BEBE;
    }

    .gantt_task_line, .gantt_line_wrapper {
        margin-top: -12px;
    }
    .gantt_side_content {
        margin-bottom: 7px;
    }
    .gantt_task_link .gantt_link_arrow {
        margin-top: -12px
    }
    .gantt_side_content.gantt_right {
        bottom: 0;
    }
    .gantt_milestone .gantt_side_content.gantt_right{
        top: 2px;
        left: 0px;
        color: #ffffff;
    }

    html, body {
        padding: 0px;
        margin: 0px;
        height: 100%;
    }
    </style>
</head>
<body>
<div id="a">
    <div>
        <div style="height: 100%; padding: 0px;margin: 0px;overflow: hidden;">

            <div id="gantt_here" style='width:100%; height:800px;'></div>
        </div>
    </div>
</div>
<script type="text/javascript">

    var demo_tasks = {
        "data": [
            {"id": 1, "text": "Program Gate",  "progress": 0.5, "render":"split", "open": true, "start_date": "2019-01-01"},

            {"id": 12, "text": "", "start_date": "2019-01-01", "end_date":"2022-08-01", "type": "task", "parent": "1", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id": 2, "text": "K0", "start_date": "2019-01-08", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 3, "text": "G0", "start_date": "2019-05-05", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},

            {"id": 4, "text": "G1", "start_date": "2019-09-11", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 5, "text": "G1.2", "start_date": "2020-02-01", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 6, "text": "G1.3", "start_date": "2020-06-05", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 7, "text": "G1.3", "start_date": "2020-09-30", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 8, "text": "G1.F", "start_date": "2021-08-15", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 9, "text": "G1.5", "start_date": "2021-12-11", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 10, "text": "G1.6", "start_date": "2022-02-01", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},
            {"id": 11, "text": "G1.6", "start_date": "2022-05-01", "duration": 0, "type": "milestone", "parent": "1", "progress": 0.5, "open": true, color : "#FCF794"},

            {"id": 13, "text": "Dept.1", "start_date": "2019-01-01", "end_date": "2019-03-05", "type": "task", "progress": 0.5, "open": true, color : "#00BEBE"},

            {"id": 14, "text": "Dept.2",  "progress": 0.5, "render":"split", "open": true, "start_date": "2019-01-01"},
            {"id": 15, "text": "task2", "start_date": "2019-01-08", "end_date": "2020-07-05", "type": "task", "parent": "14", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id": 16, "text": "task3", "start_date": "2020-09-05", "end_date": "2021-06-05", "type": "task", "parent": "14", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id": 17, "text": "M1", "start_date": "2019-03-08", "duration": 0, "type": "milestone", "parent": "14", "progress": 0.5, "open": true, color : "#000000"},
            {"id": 18, "text": "M2", "start_date": "2020-01-05", "duration": 0, "type": "milestone", "parent": "14", "progress": 0.5, "open": true, color : "#000000"},

            {"id": 19, "text": "task4", type : "task", "progress": 0.5, "open": true, color : "#00BEBE"},

            {"id": 20, "text": "Sub Dept.1",  "progress": 0.5, "type": "task", "parent":"19", "render":"split",  "open": true,  color : "#00BEBE"},
            {"id":21, "text":"Task5", "start_date":"2020-01-05", "end_date": "2020-03-05", "parent":"20", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id":22, "text":"Task6", "start_date":"2020-03-05", "end_date": "2020-06-05", "parent":"20", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id":23, "text":"Task7", "start_date":"2020-07-05", "end_date": "2020-10-05", "parent":"20", "progress": 0.5, "open": true, color : "#00BEBE"},

            {"id": 24, "text": "Sub Dept.2",  "progress": 0.5, "type": "task", "parent":"19", "render":"split",  "open": true,  color : "#00BEBE"},
            {"id":25, "text":"Task8", "start_date":"2020-03-06", "end_date": "2020-05-01", "parent":"24", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id":26, "text":"Task9", "start_date":"2020-05-01", "end_date": "2020-09-05", "parent":"24", "progress": 0.5, "open": true, color : "#00BEBE"},
            {"id":27, "text":"M3", "start_date":"2020-05-01", "type": "milestone", "end_date": "2020-10-05", "parent":"24", "progress": 0.5, "open": true, color : "#FCF794"},

            {"id": 28, "text": "Dept.4", "start_date": "2019-05-01", "end_date": "2020-03-05", "type": "task", "progress": 0.5, "open": true, color : "#00BEBE"},
        ],
        "links": [
        ]
    };

/*    var date_to_str = gantt.date.date_to_str(gantt.config.task_date);
    var today = new Date();
    gantt.addMarker({
        start_date: today,
        css: "today",
        text: "Today",
        title: "Today: " + date_to_str(today)
    });*/

    gantt.config.columns = [
        {name:"text",       label:"Project/Version/Issue", min_width: 100, max_width:200, tree:true },
       /* {name:"start_date", label:"Start time", align:"center" , min_width: 110},
        {name:"end_date", label:"Finish time", align:"center" , min_width: 110},*/
       /* {name:"duration",   label:"Duration",   align:"center" },
        {name:"progress",   label:"Percent",   align:"center", template:function(obj){
            return ((parseFloat(obj.progress ).toFixed(4)) * 100).toFixed(0) + '%'; } },*/
        /*{name:"add",        label:"",           width:44 }*/
    ];

    gantt.templates.grid_header_class = function(columnName, column){
        return "nioBlue";
    };

    var daysStyle = function(date){
        if(date.getDay()==0||date.getDay()==6){
            return "weekend";
        }else{
            return "";
        }
    };

    gantt.templates.task_cell_class = function (item, date) {
        if (date.getDay() == 0 || date.getDay() == 6) {
            return "weekend"
        }
    };

    gantt.templates.scale_cell_class = function(date){
        return 'nioBlue';
    };

    gantt.config.fit_tasks = true;
    gantt.config.api_date = "%Y-%m-%d %H:%i";
    gantt.config.xml_date = "%Y-%m-%d %H:%i";

    gantt.config.scale_unit = "year";  //"minute", "hour", "day", "week", "quarter", "month", "year"
    gantt.config.step = 1;
    //D 星期， j  d  几号，  F  月份, M 月份，W week,
    gantt.config.date_scale = "%Y"; //Default value: "%d %M"；
    gantt.config.subscales = [
        {unit: "month", step: 1, date: "%F", css: daysStyle}
    ];
    gantt.config.scale_height = 50;
    gantt.config.min_column_width = 60;
    gantt.config.order_branch = 'marker';
//    gantt.config.task_height = 15;

    gantt.config.task_height = 16;
    gantt.config.row_height = 40;


    var opts = [
        { key: 1, label: 'High' },
        { key: 2, label: 'Normal' },
        { key: 3, label: 'Low' }
    ];

    gantt.locale.labels.section_priority = "Priority";

    gantt.config.lightbox.sections = [
        {name:"description", height:38, map_to:"text", type:"textarea", focus:true},
        {name:"priority",    height:22, map_to:"priority", type:"select", options:opts},
        {name:"time",        height:72, map_to:"auto", type:"duration"}
    ];
//  定义左侧、右侧 显示文字
//    leftside_text
    gantt.templates.bottom_text = function(start, end, task){
        if(task.type == gantt.config.types.milestone){
            return gantt.date.date_to_str('%Y-%m-%d')(start);
        }
        return "";
    };

    gantt.templates.rightside_text = function(start, end, task){
        if(task.type == gantt.config.types.milestone  ){
            return task.text;
        }
        return "";
    };
    gantt.templates.task_text=function(start, end, task){
        return task.text;
    };

    gantt.init("gantt_here");
    gantt.parse(demo_tasks);

</script>
</body>
</html>